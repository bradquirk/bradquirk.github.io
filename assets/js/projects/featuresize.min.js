d3.csv("/assets/csv/projects/featuresize.csv").then(function(t){t.forEach(function(t){t.key=t["Feature Link"],t.total=+t.Total});var e={top:10,right:50,bottom:50,left:50},a=$("#chart").width()-e.left-e.right,r=.6*$(window).innerHeight()-e.top-e.bottom,l=d3.select("#chart").append("svg").attr("width",a+e.left+e.right).attr("height",r+e.top+e.bottom).append("g").attr("transform","translate("+e.left+","+e.top+")"),n=d3.select("#chart").append("div").attr("id","tooltip").style("position","absolute").style("visibility","hidden"),o=d3.scaleLinear().domain([0,d3.max(t,t=>t.total)]).range([0,a]);d3.scaleSequential().interpolator(function(t,e){var a=0,r=e.length-1,l=e[0],i=new Array(r<0?0:r);for(;a<r;)i[a]=t(l,l=e[++a]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return i[e](t-e)}}(d3.interpolateRgb,["white","yellow"])).domain([0,t.length]);l.append("g").attr("transform","translate(0,"+r+")").attr("class","axis").call(d3.axisBottom(o)),l.append("text").attr("class","axis").attr("transform","translate("+a/2+" ,"+(r+e.top+25)+")").style("text-anchor","middle").text("Size of Feature (Number of User Stories)");var s=d3.histogram().value(function(t){return t.total}).domain(o.domain()).thresholds(o.ticks(o.domain()[1]/2))(t);s.unshift({x0:0,x1:0,length:0});var c=d3.scaleLinear().range([r,0]).domain([0,d3.max(s,function(t){return t.length})]);l.append("g").attr("class","axis").call(d3.axisLeft(c)),l.append("text").attr("class","axis").attr("transform","rotate(-90)").attr("y",0-e.left).attr("x",0-r/2).attr("dy","1em").style("text-anchor","middle").text("Frequency"),l.selectAll("rect").data(s).enter().append("rect").attr("class","bar").attr("x",1).attr("transform",function(t){return"translate("+o(t.x0)+","+c(t.length)+")"}).attr("width",function(t){return o(t.x1)-o(t.x0)-1}).attr("height",function(t){return r-c(t.length)}).style("fill","white").style("opacity",.3);var d=d3.area().x(t=>o(t.x0)+(o(t.x1)-o(t.x0))/2).y0(c(0)).y1(t=>c(t.length)),h=l.append("path").data([s]).attr("class","path").attr("id","areachart").attr("clip-path","url(#clip)").attr("d",d).style("stroke-width","2px").style("stroke","#FDBB32").style("fill","#FDBB32").style("fill-opacity",.2),p=l.append("g").attr("class","mouse-over-effects");p.append("line").attr("class","mouse-line").style("stroke-width","1px").style("opacity","0"),p.append("circle").attr("id","circle").attr("class","hoverCircle").attr("r",7).style("stroke-width","1px").style("opacity","0");p.append("rect").attr("width",a).attr("height",r).attr("fill","none").attr("pointer-events","all").on("mouseout",function(){d3.selectAll(".hoverCircle").transition().style("opacity","0"),d3.selectAll(".hoverBackground").transition().style("opacity","0"),d3.selectAll(".hoverText").transition().style("opacity","0"),d3.select("#areachart").transition().style("opacity","0"),n.transition().style("visibility","hidden"),d3.selectAll(".bar").transition().style("opacity",.3)}).on("mouseover",function(){d3.selectAll(".hoverCircle").transition().style("opacity","1"),d3.selectAll(".hoverBackground").transition().style("opacity","1"),d3.selectAll(".hoverText").transition().style("opacity","1"),d3.select("#areachart").transition().style("opacity","1"),d3.selectAll(".bar").transition().style("opacity",.1)}).on("mousemove",function(){!function(a,l){var s=document.getElementById("chart").getBoundingClientRect().left,c=h.node(),d=c.getTotalLength(),p=d3.bisector(t=>t.x1).right;d3.selectAll(".mouse-line").attr("x1",a[0]).attr("x2",a[0]).attr("y1",r).attr("y2",0),d3.select("#clip").select("rect").attr("width",a[0]);var u=d3.event.pageX-s-e.left-14,g=l[p(l,o.invert(u))],x=p(l,o.invert(u)),m=d3.sum(l.slice(0,x+1),t=>t.length);for(i=u;i<d;i+=1){var v=c.getPointAtLength(i);if(v.x>=u)break}d3.select("#circle").style("fill","white").style("opacity",1).attr("cx",u).attr("cy",v.y);var w=d3.mouse(y.node());f.x=window.scrollX,f.y=window.scrollY,n.style("right",""),n.style("left",""),n.style("bottom",""),n.style("top",""),n.html("<p id='heading'><span style='color:#FDBB32;'> "+m+" Features </span>(or "+d3.format(".0%")(m/t.length)+" of the "+t.length+" Features recorded) <span style='color:#FDBB32;'><br>hold "+g.x1+" User Stories </span>or less within them.</p>"),n.style("height",$("#heading").height()),w[0],f.x,f.w,n.style("left",u+e.left+15+"px");w[1],f.y,f.h,n.style("top",v.y-$("#tooltip").height()-15+"px");n.style("visibility","visible")}(d3.mouse(this),s)}),l.append("clipPath").attr("id","clip").append("rect").attr("x",0).attr("y",0).attr("width",a).attr("height",r);var y=d3.select("svg"),f={x:window.scrollX,y:window.scrollY,w:window.innerWidth,h:window.innerHeight},u=d3.select("#chart");u.node().offsetWidth,u.node().offsetHeight,document.width,document.height,function(t){for(var e=d3.select("body").node(),a=0,r=0;null!=t&&t!=e;a+=t.offsetLeft||t.clientLeft,r+=t.offsetTop||t.clientTop,t=t.offsetParent||t.parentNode);}(y.node())});