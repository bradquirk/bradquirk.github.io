d3.csv("/assets/csv/projects/findingcorrelation.csv").then(function(e){var t=d3.utcParse("%Y-%m-%dT%H:%M:%S"),n=d3.timeFormat("%Y-%m-%d"),i=(d3.timeParse("%Y-%m-%d"),d3.timeFormat("%e %b '%y"),n(t(0)),[]);e=function(e){return e.forEach((t,n)=>{var i=d3.max(e,e=>+e.Key.substring(e.Key.indexOf("-")+1,e.Key.length).length);for(key=t.Key.substring(0,t.Key.indexOf("-")),number=t.Key.substring(t.Key.indexOf("-")+1,t.Key.length),k=number.length;k<i;k++)number="0"+number;t.key=key+"-"+number}),e.sort((e,t)=>{var n=e.Key.substring(0,e.Key.indexOf("-")),i=t.Key.substring(0,t.Key.indexOf("-")),a=+e.Key.substring(e.Key.indexOf("-")+1,e.Key.length),r=+t.Key.substring(t.Key.indexOf("-")+1,t.Key.length);return n<i?-1:n>i?1:a<r?-1:a>r?1:0}),e.forEach((e,t)=>{e.index=t}),e}(e);var a,r,s=50,c=100,o=10,l=100,u=d3.select("#chart").node().getBoundingClientRect().width-l-c,d=.4*$(window).innerHeight()-s-o,f=d-2,p=window.devicePixelRatio||1,y=d3.scaleSequential().interpolator(function(e,t){var n=0,i=t.length-1,a=t[0],r=new Array(i<0?0:i);for(;n<i;)r[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(i-1,Math.floor(e*=i)));return r[t](e-t)}}(d3.interpolateHcl,["#A0FE65","#FA016D"])).domain([0,e.length-1]),m={Number:{key:"Number",coerce:function(e){return+e},extent:d3.extent,within:function(e,t,n){return t[0]<=n.scale(e)&&n.scale(e)<=t[1]},defaultScale:d3.scaleLinear().range([f,0])},String:{key:"String",coerce:String,extent:function(e){return e.sort()},within:function(e,t,n){return t[0]<=n.scale(e)&&n.scale(e)<=t[1]},defaultScale:d3.scalePoint().range([0,f])},Date:{key:"Date",coerce:function(e){return new Date(e)},extent:d3.extent,within:function(e,t,n){return t[0]<=n.scale(e)&&n.scale(e)<=t[1]},defaultScale:d3.scaleTime().range([0,f])}};a=function(){var t=[];new Set(e.map(e=>e.key)).size>1&&t.push({key:"key",description:"Jira Key",type:m.String,axis:d3.axisLeft().tickFormat(function(t,n){let i=Math.ceil(new Set(e.map(e=>e.key)).size/10);if(n%i==0)return t})});new Set(e.map(e=>e["Epic Name"])).size>1&&t.push({key:"Epic Name",description:"Epic Name",type:m.String,axis:d3.axisLeft().tickFormat(function(t,n){let i=Math.ceil(new Set(e.map(e=>e["Epic Name"])).size/10);if(n%i==0)return t.substring(0,15)+"..."})});new Set(e.map(e=>e["Cost of Delay"])).size>1&&t.push({key:"Cost of Delay",description:"Cost of Delay",type:m.String,axis:d3.axisLeft().tickFormat(function(t,n){let i=Math.ceil(new Set(e.map(e=>e["Cost of Delay"])).size/10);if(n%i==0)return t})});new Set(e.map(e=>e["Resolved Name"])).size>1&&t.push({key:"Resolved Name",description:"Resolution",type:m.String,axis:d3.axisLeft().tickFormat(function(t,n){let i=Math.ceil(new Set(e.map(e=>e["Resolved Name"])).size/10);if(n%i==0)return t})});new Set(e.map(e=>e["Story Points"])).size>1&&t.push({key:"Story Points",description:"Story Points",type:m.Number,scale:d3.scaleSqrt().range([f,0])});new Set(e.map(e=>e["Cycle Time (Bus. Days)"])).size>1&&t.push({key:"Cycle Time (Bus. Days)",description:"Cycle Time",type:m.Number,scale:d3.scaleSqrt().range([f,0])});new Set(e.map(e=>e["Lead Time (Bus. Days)"])).size>1&&t.push({key:"Lead Time (Bus. Days)",description:"Lead Time",type:m.Number,scale:d3.scaleSqrt().range([f,0])});new Set(e.map(e=>e["Created Date"])).size>1&&t.push({key:"Created Date",description:"Created Date",type:m.Date});new Set(e.map(e=>e["First In Progress Date"])).size>1&&t.push({key:"First In Progress Date",description:"In Progress Date",type:m.Date});new Set(e.map(e=>e["Last Resolved Date"])).size>1&&t.push({key:"Last Resolved Date",description:"Resolved Date",type:m.Date});return t}(),r="key",i=a.map(e=>e[r]).map((e,t,n)=>n.indexOf(e)===t&&t).filter(e=>a[e]).map(e=>a[e]);var h=d3.scalePoint().domain(d3.range(i.length)).range([0,u]);$("#chart").height(d+s+o),$("#table").height((d+s+o)/2);var g=d3.select("#chart"),x=g.append("svg").attr("width",u+l+c).attr("height",d+s+o).append("g").attr("transform","translate("+l+","+s+")"),v=g.append("canvas").attr("width",u*p).attr("height",d*p).style("width",u+"px").style("height",d+"px").style("margin-top",s+"px").style("margin-left",l+"px").node().getContext("2d");v.globalAlpha=.1,v.lineWidth=1.5,v.scale(p,p);var w=d3.select("#table").append("pre");e.forEach(function(e){for(var t in i.forEach(function(t){e[t.key]=e[t.key]?t.type.coerce(e[t.key]):null}),e)e[t]&&e[t].length>35&&(e[t]=e[t].slice(0,36))}),i.forEach(function(t){var n;"domain"in t||(t.domain=("function"==typeof(n=t.type.extent)?n:function(){return n})(e.map(function(e){return e[t.key]}))),"scale"in t||(t.scale=t.type.defaultScale.copy()),t.scale.domain(t.domain)}),e=d3.shuffle(e);var S=renderQueue(function(e){v.strokeStyle=y(e.index),v.beginPath();var t=function(e){return i.map(function(t,n){return t.key in e&&null!==e[t.key]?[h(n),t.scale(e[t.key])]:null})}(e);t.forEach(function(e,n){if(null!==e)0!=n?v.lineTo(e[0],e[1]):v.moveTo(e[0],e[1]);else{if(n>0){var i=t[n-1];null!==i&&(v.moveTo(i[0],i[1]),v.lineTo(i[0]+6,i[1]))}if(n<t.length-1){var a=t[n+1];null!==a&&v.moveTo(a[0]-6,a[1])}}}),v.stroke()}).rate(e.length/50);v.clearRect(0,0,u,d),S(e);var b=x.selectAll(".axis").data(i).enter().append("g").attr("class",function(e){return"axis "+e.key.replace(/ /g,"_")}).attr("transform",function(e,t){return"translate("+h(t)+")"});function D(){d3.event.sourceEvent.stopPropagation()}function K(){S.invalidate();var t=[];x.selectAll(".axis .brush").filter(function(e){return d3.brushSelection(this)}).each(function(e){t.push({dimension:e,extent:d3.brushSelection(this)})});var n=e.filter(function(e){if(t.every(function(t){var n=t.dimension;return n.type.within(e[n.key],t.extent,n)}))return!0});x.selectAll(".axis").filter(function(e){return t.indexOf(e)>-1}).classed("active",!0).each(function(e,t){var n=extents[t];d3.select(this).selectAll(".tick text").style("display",function(t){var i=e.type.coerce(t);return e.type.within(i,n,e)?null:"none"})}),x.selectAll(".axis").filter(function(e){return!(t.indexOf(e)>-1)}).classed("active",!1).selectAll(".tick text").style("display",null),v.clearRect(0,0,u,d),S(n),w.text(d3.tsvFormat(n.slice())),n}b.append("g").each(function(e){var t="axis"in e?e.axis.scale(e.scale):d3.axisLeft().scale(e.scale);d3.select(this).call(t)}).append("text").attr("class","title").attr("text-anchor","start").text(function(e){return"description"in e?e.description:e.key}),b.append("g").attr("class","brush").each(function(e){d3.select(this).call(e.brush=d3.brushY().extent([[-10,0],[10,d]]).on("start",D).on("brush",K).on("end",K))}).selectAll("rect").attr("x",-8).attr("width",16),w.text(d3.tsvFormat(e.slice()))});var renderQueue=function(e){var t=[],n=1e3,i=function(){},a=function(){},r=function(e){e&&r.data(e),i(),a(),r.render()};r.render=function(){var a=!0;i=r.invalidate=function(){a=!1},function i(){if(!a)return!0;t.splice(0,n).map(e),s(i)}()},r.data=function(e){return i(),t=e.slice(0),r},r.add=function(e){t=t.concat(e)},r.rate=function(e){return arguments.length?(n=e,r):n},r.remaining=function(){return t.length},r.clear=function(e){return arguments.length?(a=e,r):(a(),r)},r.invalidate=i;var s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};return r};